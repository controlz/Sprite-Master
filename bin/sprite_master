#!/usr/bin/env ruby
require 'sprite_master'

if ARGV.count < 1
  puts "Invalid usage. Type sprite_master --help for assistance."
elsif ARGV[0].downcase == '--help' || ARGV[0].downcase == '-h'
  puts "---------------------------"
  puts "SPRITE MASTER VERSION 0.0.0"
  puts "---------------------------"
  puts "Sprite Master is a utility to automatically generate stylesheets and supporting docs from sprite sheets generated using Zwoptex.app. You can use the raw plist files generated by Zwoptex.app for coordinates or you can convert them to json using the free online tool at http://json.online-toolz.com/tools/xml-json-convertor.php."
  puts "\n"
  puts "USAGE"
  puts "sprite_master <image> <data> <prefix> <(optional) format>"
  puts "\n"
  puts "NOTES"
  puts "<image> must be a png image file. Assumes .png extension."
  puts "<data> must be a Zwoptex-generated file. Assumes .plist extension."
  puts "<prefix>- will be prepended to generated css classes."
  puts "<format> is optional. xml, plist, and json are valid." 
  puts "DO NOT INCLUDE FILE EXTENSIONS IN FILE NAMES."
  puts "\n"
  puts "THANK YOU FOR USING SPRITE MASTER TO TAME YOUR SPRITES."
  puts "----------------------------"
elsif ARGV[0].downcase == '--version' || ARGV[0].downcase == '-v'
  puts "SPRITE MASTER VERSION 0.0.0"
elsif ARGV.count > 2 and ARGV.count < 5
  sprite_master = SpriteMaster.new({
      img: ARGV[0],
      src: ARGV[1],
      prefix: ARGV[2],
      format: ARGV[3] || 'plist'
    })
  result = sprite_master.generate_css
  unless result.nil?
    puts "Generated css file: #{result}"
  else
    puts "Failed to generate css file!"
  end
  
  result = sprite_master.generate_docs
  unless result.nil?
    puts "Generated doc file: #{result}"
  else
    puts "Failed to generate docs!"
  end
else
  puts "Invalid usage. Type sprite_master --help for assistance."
end